{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst imagesGallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loader = document.querySelector('.loader');\n\nconst BASE_URL = 'https://pixabay.com/api/?';\nconst API_KEY = '41838849-75d2e43a80bdb544c2e4afc3a';\n\nconst searchParamsDefault = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n};\n\nlet currentPage = 1;\nlet searchQuery = '';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  close: true,\n  enableKeyboard: true,\n  docClose: true,\n});\n\nconst showLoader = state => {\n  loader.style.display = state ? 'block' : 'none';\n};\n\nconst showLoadMoreBtn = state => {\n  loadMoreBtn.style.display = state ? 'block' : 'none';\n};\n\nconst appendImagesToGallery = hits => {\n  const newImages = hits.map(\n    image =>\n      `\n        <li class=\"gallery-item\">\n          <a href=${image.largeImageURL}>\n            <img class=\"gallery-img\" src=${image.webformatURL} alt=${image.tags}/>\n          </a>\n          <div class=\"gallery-text-box\">\n            <p>Likes: <span class=\"text-value\">${image.likes}</span></p>\n            <p>Views: <span class=\"text-value\">${image.views}</span></p>\n            <p>Comments: <span class=\"text-value\">${image.comments}</span></p>\n            <p>Downloads: <span class=\"text-value\">${image.downloads}</span></p>\n          </div>\n        </li>\n      `\n  );\n  imagesGallery.insertAdjacentHTML('beforeend', newImages.join(''));\n  lightbox.refresh();\n};\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  showLoader(true);\n\n  searchQuery = encodeURIComponent(event.target.elements.search.value.trim());\n\n  if (searchQuery === '') {\n    console.error('Please enter a valid search query.');\n    return;\n  }\n\n  currentPage = 1;\n\n  try {\n    await getImages(searchQuery, currentPage);\n  } catch (error) {\n    console.error(error.message);\n  } finally {\n    showLoader(false);\n  }\n  event.target.reset();\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  showLoadMoreBtn(false);\n  currentPage++;\n  try {\n    await getImages(searchQuery, currentPage);\n  } catch (error) {\n    console.error(error.message);\n  } finally {\n    showLoader(false);\n  }\n});\n\nconst getGalleryCardHeight = () => {\n  const firstGalleryCard = document.querySelector('.gallery-item');\n  if (firstGalleryCard) {\n    const cardHeight = firstGalleryCard.getBoundingClientRect().height;\n    return cardHeight;\n  }\n  return 0;\n};\n\nconst scrollPageByGalleryCardHeight = () => {\n  const cardHeight = getGalleryCardHeight();\n  if (cardHeight > 0) {\n  } else {\n    console.warn('Gallery card not found. Sorry, you can`t scroll.');\n  }\n};\n\nconst showEndOfResultsMessage = () => {\n  iziToast.info({\n    position: 'topRight',\n    messageColor: '#FFFFFF',\n    backgroundColor: '#36B3D9',\n    titleSize: '8px',\n    closeOnEscape: true,\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n};\n\nconst getImages = async (query, page) => {\n  const response = await axios.get(BASE_URL, {\n    params: {\n      q: query,\n      page: page,\n      per_page: searchParamsDefault.per_page,\n      key: API_KEY,\n    },\n  });\n  const { hits, totalHits } = response.data;\n\n  if (!hits || hits.length === 0) {\n    if (page === 1) {\n      iziToast.error({\n        position: 'topRight',\n        messageColor: '#FFFFFF',\n        backgroundColor: '#EF4040',\n        titleSize: '8px',\n        closeOnEscape: true,\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    } else {\n      showEndOfResultsMessage();\n    }\n  } else {\n    if (page === 1) {\n      imagesGallery.innerHTML = '';\n    }\n    appendImagesToGallery(hits);\n\n    if (totalHits && imagesGallery.childElementCount >= totalHits) {\n      showLoadMoreBtn(false);\n      showEndOfResultsMessage();\n    } else {\n      showLoadMoreBtn(true);\n      scrollPageByGalleryCardHeight();\n    }\n  }\n};\n"],"names":["form","imagesGallery","loadMoreBtn","loader","BASE_URL","API_KEY","searchParamsDefault","currentPage","searchQuery","lightbox","SimpleLightbox","showLoader","state","showLoadMoreBtn","appendImagesToGallery","hits","newImages","image","event","getImages","error","getGalleryCardHeight","firstGalleryCard","scrollPageByGalleryCardHeight","showEndOfResultsMessage","iziToast","query","page","response","axios","totalHits"],"mappings":"owBAMA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAgB,SAAS,cAAc,UAAU,EACjDC,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAS,SAAS,cAAc,SAAS,EAEzCC,EAAW,4BACXC,EAAU,qCAEVC,EAAsB,CAC1B,IAAKD,EACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,EACZ,EAEA,IAAIE,EAAc,EACdC,EAAc,GAElB,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,IACd,MAAO,GACP,eAAgB,GAChB,SAAU,EACZ,CAAC,EAEKC,EAAaC,GAAS,CAC1BT,EAAO,MAAM,QAAUS,EAAQ,QAAU,MAC3C,EAEMC,EAAkBD,GAAS,CAC/BV,EAAY,MAAM,QAAUU,EAAQ,QAAU,MAChD,EAEME,EAAwBC,GAAQ,CACpC,MAAMC,EAAYD,EAAK,IACrBE,GACE;AAAA;AAAA,oBAEcA,EAAM;AAAA,2CACiBA,EAAM,oBAAoBA,EAAM;AAAA;AAAA;AAAA,iDAG1BA,EAAM;AAAA,iDACNA,EAAM;AAAA,oDACHA,EAAM;AAAA,qDACLA,EAAM;AAAA;AAAA;AAAA,OAI3D,EACEhB,EAAc,mBAAmB,YAAae,EAAU,KAAK,EAAE,CAAC,EAChEP,EAAS,QAAO,CAClB,EAEAT,EAAK,iBAAiB,SAAU,MAAMkB,GAAS,CAM7C,GALAA,EAAM,eAAc,EACpBP,EAAW,EAAI,EAEfH,EAAc,mBAAmBU,EAAM,OAAO,SAAS,OAAO,MAAM,KAAI,CAAE,EAEtEV,IAAgB,GAAI,CACtB,QAAQ,MAAM,oCAAoC,EAClD,MACD,CAEDD,EAAc,EAEd,GAAI,CACF,MAAMY,EAAUX,EAAaD,CAAW,CACzC,OAAQa,EAAP,CACA,QAAQ,MAAMA,EAAM,OAAO,CAC/B,QAAY,CACRT,EAAW,EAAK,CACjB,CACDO,EAAM,OAAO,OACf,CAAC,EAEDhB,EAAY,iBAAiB,QAAS,SAAY,CAChDW,EAAgB,EAAK,EACrBN,IACA,GAAI,CACF,MAAMY,EAAUX,EAAaD,CAAW,CACzC,OAAQa,EAAP,CACA,QAAQ,MAAMA,EAAM,OAAO,CAC/B,QAAY,CACRT,EAAW,EAAK,CACjB,CACH,CAAC,EAED,MAAMU,EAAuB,IAAM,CACjC,MAAMC,EAAmB,SAAS,cAAc,eAAe,EAC/D,OAAIA,EACiBA,EAAiB,sBAAqB,EAAG,OAGvD,CACT,EAEMC,EAAgC,IAAM,CACvBF,IACF,GAEf,QAAQ,KAAK,kDAAkD,CAEnE,EAEMG,EAA0B,IAAM,CACpCC,EAAS,KAAK,CACZ,SAAU,WACV,aAAc,UACd,gBAAiB,UACjB,UAAW,MACX,cAAe,GACf,QAAS,4DACb,CAAG,CACH,EAEMN,EAAY,MAAOO,EAAOC,IAAS,CACvC,MAAMC,EAAW,MAAMC,EAAM,IAAIzB,EAAU,CACzC,OAAQ,CACN,EAAGsB,EACH,KAAMC,EACN,SAAUrB,EAAoB,SAC9B,IAAKD,CACN,CACL,CAAG,EACK,CAAE,KAAAU,EAAM,UAAAe,GAAcF,EAAS,KAEjC,CAACb,GAAQA,EAAK,SAAW,EACvBY,IAAS,EACXF,EAAS,MAAM,CACb,SAAU,WACV,aAAc,UACd,gBAAiB,UACjB,UAAW,MACX,cAAe,GACf,QACE,0EACV,CAAO,EAEDD,KAGEG,IAAS,IACX1B,EAAc,UAAY,IAE5Ba,EAAsBC,CAAI,EAEtBe,GAAa7B,EAAc,mBAAqB6B,GAClDjB,EAAgB,EAAK,EACrBW,MAEAX,EAAgB,EAAI,EACpBU,KAGN"}