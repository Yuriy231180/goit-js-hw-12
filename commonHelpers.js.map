{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst imagesGallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loader = document.querySelector('.loader');\n\nconst BASE_URL = 'https://pixabay.com/api/?';\nconst API_KEY = '41838849-75d2e43a80bdb544c2e4afc3a';\n\nconst searchParamsDefault = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n};\n\nlet currentPage = 1;\nlet searchQuery = '';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  close: true,\n  enableKeyboard: true,\n  docClose: true,\n});\n\nconst showLoader = state => {\n  loader.style.display = state ? 'block' : 'none';\n};\n\nconst showLoadMoreBtn = state => {\n  loadMoreBtn.style.display = state ? 'block' : 'none';\n};\n\nconst appendImagesToGallery = hits => {\n  // const newImages = hits.map(\n  //   image =>\n  //     `\n  //       <li class=\"gallery-item\">\n  //         <a href=${image.largeImageURL}>\n  //           <img class=\"gallery-img\" src=${image.webformatURL} alt=${image.tags}/>\n  //         </a>\n  //         <div class=\"gallery-text-box\">\n  //           <p>Likes: <span class=\"text-value\">${image.likes}</span></p>\n  //           <p>Views: <span class=\"text-value\">${image.views}</span></p>\n  //           <p>Comments: <span class=\"text-value\">${image.comments}</span></p>\n  //           <p>Downloads: <span class=\"text-value\">${image.downloads}</span></p>\n  //         </div>\n  //       </li>\n  //     `\n  // );\n  // imagesGallery.innerHTML += newImages.join('');\n  // lightbox.refresh();\n\n  const fragment = document.createDocumentFragment();\n\n  hits.forEach(image => {\n    const galleryItem = document.createElement('li');\n    galleryItem.classList.add('gallery-item');\n\n    const link = document.createElement('a');\n    link.href = image.largeImageURL;\n\n    const img = document.createElement('img');\n    img.classList.add('gallery-img');\n    img.src = image.webformatURL;\n    img.alt = image.tags;\n\n    const textBox = document.createElement('div');\n    textBox.classList.add('gallery-text-box');\n    textBox.innerHTML = `\n      <p>Likes: <span class=\"text-value\">${image.likes}</span></p>\n      <p>Views: <span class=\"text-value\">${image.views}</span></p>\n      <p>Comments: <span class=\"text-value\">${image.comments}</span></p>\n      <p>Downloads: <span class=\"text-value\">${image.downloads}</span></p>\n    `;\n\n    link.appendChild(img);\n    galleryItem.appendChild(link);\n    galleryItem.appendChild(textBox);\n    fragment.appendChild(galleryItem);\n  });\n\n  imagesGallery.appendChild(fragment);\n  lightbox.refresh();\n};\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  showLoader(true);\n\n  searchQuery = encodeURIComponent(event.target.elements.search.value.trim());\n\n  if (searchQuery === '') {\n    console.error('Please enter a valid search query.');\n    return;\n  }\n\n  currentPage = 1;\n\n  await getImages(searchQuery, currentPage);\n  event.currentTarget.reset();\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  showLoadMoreBtn(false);\n  currentPage++;\n  await getImages(searchQuery, currentPage);\n});\n\nconst getGalleryCardHeight = () => {\n  const firstGalleryCard = document.querySelector('.gallery-item');\n  if (firstGalleryCard) {\n    const cardHeight = firstGalleryCard.getBoundingClientRect().height;\n    return cardHeight;\n  }\n  return 0;\n};\n\nconst scrollPageByGalleryCardHeight = () => {\n  const cardHeight = getGalleryCardHeight();\n  if (cardHeight > 0) {\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } else {\n    console.warn('Gallery card not found. Sorry, you can`t scroll.');\n  }\n};\n\nconst showEndOfResultsMessage = () => {\n  iziToast.info({\n    position: 'topRight',\n    messageColor: '#FFFFFF',\n    backgroundColor: '#36B3D9',\n    titleSize: '8px',\n    closeOnEscape: true,\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n};\n\nconst getImages = async (query, page) => {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        q: query,\n        page: page,\n        per_page: searchParamsDefault.per_page,\n        key: API_KEY,\n      },\n    });\n    const { hits, totalHits } = response.data;\n\n    // if (hits.length === 0 && page === 1) {\n    //   iziToast.error({\n    if (!hits || hits.length === 0) {\n      if (page === 1) {\n        iziToast.error({\n          position: 'topRight',\n          messageColor: '#FFFFFF',\n          backgroundColor: '#EF4040',\n          titleSize: '8px',\n          closeOnEscape: true,\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n        imagesGallery.innerHTML = '';\n        // } else if (hits.length === 0 && page > 1) {\n      } else {\n        showEndOfResultsMessage();\n      }\n    } else {\n      if (page === 1) {\n        imagesGallery.innerHTML = '';\n      }\n      appendImagesToGallery(hits);\n\n      if (totalHits && imagesGallery.childElementCount >= totalHits) {\n        showLoadMoreBtn(false);\n        showEndOfResultsMessage();\n      } else {\n        showLoadMoreBtn(true);\n        scrollPageByGalleryCardHeight();\n      }\n    }\n  } catch (error) {\n    console.error(error.message);\n  } finally {\n    showLoader(false);\n  }\n};\n"],"names":["form","imagesGallery","loadMoreBtn","loader","BASE_URL","API_KEY","searchParamsDefault","currentPage","searchQuery","lightbox","SimpleLightbox","showLoader","state","showLoadMoreBtn","appendImagesToGallery","hits","fragment","image","galleryItem","link","img","textBox","event","getImages","getGalleryCardHeight","firstGalleryCard","scrollPageByGalleryCardHeight","cardHeight","showEndOfResultsMessage","iziToast","query","page","response","axios","totalHits","error"],"mappings":"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"}